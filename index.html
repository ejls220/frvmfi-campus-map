<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Campus AR Map</title>
    <script src="https://aframe.io/releases/1.7.1/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/3.4.7/aframe/build/aframe-ar.js"></script>
  </head>

  <body style="margin:0; overflow:hidden;">
    <a-scene
      vr-mode-ui="enabled: false"
      embedded
      arjs="sourceType: webcam; debugUIEnabled: false;">

      <!-- GPS Camera -->
      <a-camera gps-camera rotation-reader></a-camera>

      <!-- Helper function to create GLB pointers with fixed label positions -->
      <script>
        function createGLBPointer(latitude, longitude, name, pointerScale=0.5, rotation='0 0 0') {
          const scene = document.querySelector('a-scene');

          // Create pointer entity
          const pointer = document.createElement('a-entity');
          pointer.setAttribute('gps-entity-place', `latitude: ${latitude}; longitude: ${longitude};`);
          pointer.setAttribute('gltf-model', 'map_pointer_3d_icon.glb');
          pointer.setAttribute('scale', `${pointerScale} ${pointerScale} ${pointerScale}`);
          pointer.setAttribute('rotation', rotation);
          pointer.setAttribute('look-at', '[gps-camera]');
          pointer.setAttribute('visible', 'false');

          // Show pointer when model is fully loaded
          pointer.addEventListener('model-loaded', () => {
            pointer.setAttribute('visible', 'true');
          });

          // Add label above the pointer
          const label = document.createElement('a-text');
          label.setAttribute('value', name);
          label.setAttribute('color', '#FF0000');
          label.setAttribute('align', 'center');
          label.setAttribute('look-at', '[gps-camera]');
          label.setAttribute('position', `0 2 0`); // fixed 2 meters above pointer
          label.setAttribute('width', '6');        // readable text
          pointer.appendChild(label);

          scene.appendChild(pointer);
        }

        // Add campus locations
        createGLBPointer(11.024918, 124.011105, 'Library');     
        createGLBPointer(11.025500, 124.011500, 'Gym');         
        createGLBPointer(11.024400, 124.010800, 'Cafeteria');   
        createGLBPointer(11.024700, 124.011200, 'Admin Office'); 
        createGLBPointer(11.024950, 124.011300, 'Main Gate');   
      </script>

    </a-scene>
  </body>
</html>
